extends ../layout.pug 

block content 
  div.main-container
    h2 Exclusions List
    
    if user.role === 'admin' || user.role === 'supervisor'
      a(href='/add_new_exclusion')
        i.fas-icon.fas-new(class="fa-solid fa-plus")
    a(href=`/users/${user.loggedInUser}`)
      i.fas-icon.fas-account(class="fa-solid fa-user")
    a(href=`/logout`)
      i.fas-icon.fas-logout(class="fa-solid fa-right-from-bracket")

    ul.list 
      each exclusion in exclusions
        div.excl-card
          a.link(href=`/home/${exclusion._id}`)
            div.right-div
              img.image.exclusion-image(src=`${exclusion.img_url}`) 
            div.exclusion-list-item
              li.exclusion-item
                h3 Name: #{exclusion.last_name}, #{exclusion.first_name} 
                  if exclusion.dob !== '' && exclusion.dob !== 'Invalid date'
                    | (DOB: #{exclusion.dob})
              li.exclusion-item
                strong Length: 
                if exclusion.length === 'Infinity' || exclusion.length === 'Lifetime'
                  strong(class='red-filter') Lifetime 
                else 
                  | #{exclusion.length} days
              li.exclusion-item 
                strong Date Served: 
                | #{exclusion.date_served}
              li.exclusion-item 
                strong Expires after: 
                | #{exclusion.exp_date !== 'Invalid date' ? exclusion.exp_date : 'N/A'}
              li.exclusion-item 
                strong Violation(s): 
                | #{exclusion.ordinance}
              li.exclusion-item 
                strong Description: 
                | #{exclusion.description.split(' ').slice(0,32).join(' ')}...
              if exclusion.other_info !== ''
                li.exclusion-item 
                strong Other Info: 
                | #{exclusion.other_info}
                      
    //- Render links based on authorization:
    .left-btn-div
      if user.role === 'admin' || user.role === 'supervisor'
        a(href='/add_new_exclusion')
          i.fas-icon.fas-new(class="fa-solid fa-plus")
        a(href='/archive')
          i.fas-icon.fas-accounts(class="fa-solid fa-box-archive")
      if user.role === 'admin'
        a(href='/users')
          i.fas-icon.fas-accounts(class="fa-solid fa-users")
      else 
        a(href=`/users/${user.loggedInUser}`)
          i.fas-icon.fas-accounts(class="fa-solid fa-user")
    .right-btn-div
      a(href='/logout')
        i.fas-icon.fas-logout(class="fa-solid fa-right-from-bracket")